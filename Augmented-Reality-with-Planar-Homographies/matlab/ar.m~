% Q3.3.1
source = loadVid( '../data/ar_source.mov' );
dest = loadVid( '../data/book.mov' );

size_source = size(source,2);
size_dest = size(dest,2);

[m, n] = imread('../data/cv_cover.jpg');
ar_video = dest;

for i = 1:size_dest
    [locs1, locs2] = matchPics(cv_img, dest(i).cdata);
    [H2to1, ~] = computeH_ransac(locs1, locs2);
    
%         if i <= sizeS
%         cutFrame = mson(i).cdata(4:356,180:460,:);
%     else
%         cutFrame = zeros(440,355,3);
%     end
%     scaled_Frame = imresize(cutFrame, [size(cv_img,1) size(cv_img,2)]);
% 
    if i <= size_source
        source_cut = source(i).cdata(4:356,180:460,:);
        source_scaled = imresize(source_cut, [size(cv_img,1) size(cv_img,2)]);
        size(source_scaled)
    else
        source_scaled = zeros(m,n,3);
    end
    break
    ar_video(i).cdata = compositeH(inv(H2to1), source_scaled, dest(i).cdata);
end

v = VideoWriter('../Result/ar.avi');
open(v);
writeVideo(v,ar_video);
close(v);